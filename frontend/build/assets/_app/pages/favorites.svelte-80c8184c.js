import{S as A,i as K,s as X,e as R,c as F,a as C,d as T,f as I,X as Y,l as S,J as U,K as L,A as z,t as v,g as m,b as D,F as p,L as P,h as N,U as B,Y as G}from"../chunks/vendor-b7a51d2f.js";import{d as O,e as H,c as Q,v as V}from"../chunks/store-b1b2bb32.js";import{g as W}from"../chunks/navigation-51f4a605.js";import"../chunks/singletons-12a22614.js";function J(u,t,e){const n=u.slice();return n[11]=t[e],n}function M(u){let t,e=[],n=new Map,c=u[1];const f=s=>s[11]._id;for(let s=0;s<c.length;s+=1){let a=J(u,c,s),_=f(a);n.set(_,e[s]=q(_,a))}return{c(){t=R("ul");for(let s=0;s<e.length;s+=1)e[s].c()},l(s){t=F(s,"UL",{});var a=C(t);for(let _=0;_<e.length;_+=1)e[_].l(a);a.forEach(T)},m(s,a){I(s,t,a);for(let _=0;_<e.length;_+=1)e[_].m(t,null)},p(s,a){a&3&&(c=s[1],e=Y(e,a,f,1,s,c,n,t,G,q,null,J))},d(s){s&&T(t);for(let a=0;a<e.length;a+=1)e[a].d()}}}function q(u,t){let e,n=t[11].title+"",c,f,s=t[11].date+"",a,_,k=t[11].artistName+"",b,j,i,E,r,l,d,w,g,y;return{key:u,first:null,c(){e=R("li"),c=v(n),f=v(" at "),a=v(s),_=v("!The great "),b=v(k),j=v(` gonna be there!!!\u{1F91F} 
                `),i=R("input"),r=v(`
                \u274C Remove from Favorites
                `),l=R("input"),w=v(`
                Check more
            `),this.h()},l(h){e=F(h,"LI",{});var o=C(e);c=m(o,n),f=m(o," at "),a=m(o,s),_=m(o,"!The great "),b=m(o,k),j=m(o,` gonna be there!!!\u{1F91F} 
                `),i=F(o,"INPUT",{type:!0}),r=m(o,`
                \u274C Remove from Favorites
                `),l=F(o,"INPUT",{type:!0}),w=m(o,`
                Check more
            `),o.forEach(T),this.h()},h(){D(i,"type","radio"),i.__value=E={type:"favorites",action:"DELETE",eventId:t[11]._id},i.value=i.__value,t[3][0].push(i),D(l,"type","radio"),l.__value=d=t[11],l.value=l.__value,t[3][0].push(l),this.first=e},m(h,o){I(h,e,o),p(e,c),p(e,f),p(e,a),p(e,_),p(e,b),p(e,j),p(e,i),i.checked=i.__value===t[0],p(e,r),p(e,l),l.checked=l.__value===t[0],p(e,w),g||(y=[P(i,"change",t[2]),P(l,"change",t[4])],g=!0)},p(h,o){t=h,o&2&&n!==(n=t[11].title+"")&&N(c,n),o&2&&s!==(s=t[11].date+"")&&N(a,s),o&2&&k!==(k=t[11].artistName+"")&&N(b,k),o&2&&E!==(E={type:"favorites",action:"DELETE",eventId:t[11]._id})&&(i.__value=E,i.value=i.__value),o&1&&(i.checked=i.__value===t[0]),o&2&&d!==(d=t[11])&&(l.__value=d,l.value=l.__value),o&1&&(l.checked=l.__value===t[0])},d(h){h&&T(e),t[3][0].splice(t[3][0].indexOf(i),1),t[3][0].splice(t[3][0].indexOf(l),1),g=!1,B(y)}}}function Z(u){let t,e=u[1]&&u[1].length>0&&M(u);return{c(){e&&e.c(),t=S()},l(n){e&&e.l(n),t=S()},m(n,c){e&&e.m(n,c),I(n,t,c)},p(n,[c]){n[1]&&n[1].length>0?e?e.p(n,c):(e=M(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:U,o:U,d(n){e&&e.d(n),n&&T(t)}}}function $(u,t,e){let n,c,f;L(u,O,r=>e(5,n=r)),L(u,H,r=>e(6,c=r)),L(u,Q,r=>e(7,f=r));let s,a;const _=async r=>{console.log(r),V.set(r),W("/event")},k=async r=>{try{const{type:l,action:d,eventId:w}=r;let g;d=="DELETE"?g="from":g="to";const y=await fetch(`http://localhost:5000/api/user/concert-${g}-${l}/${w}`,{method:d,headers:{"Content-Type":"application/json",access_token:f,refresh_token:c}});if(console.log(y),y.status>=300)throw await y.json();const h=await y.json();O.set(h.user),e(1,s=s.filter(o=>o._id!=w)),console.log(h),O.set(h.user)}catch(l){console.error(l)}},b=async()=>{try{const r=await fetch("http://localhost:5000/api/user/concerts-by-ids",{method:"POST",headers:{"Content-Type":"application/json",access_token:f,refresh_token:c},body:JSON.stringify(n.favorites)});if(r.status>=300)throw await r.json();return(await r.json()).events}catch(r){console.error(r)}};z(async()=>{e(1,s=await b()),console.log({events:s})});const j=[[]];function i(){a=this.__value,e(0,a)}function E(){a=this.__value,e(0,a)}return u.$$.update=()=>{u.$$.dirty&1&&a&&(a._id?_(a):k(a))},[a,s,i,j,E]}class ae extends A{constructor(t){super();K(this,t,$,Z,X,{})}}export{ae as default};
