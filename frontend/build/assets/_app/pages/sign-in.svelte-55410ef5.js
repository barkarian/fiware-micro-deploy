import{S as U,i as E,s as P,e as b,t as T,c as k,a as w,g as I,d as m,f as y,F as c,h as C,k as v,n as S,b as d,R as g,L as j,T as J,Z as z,J as N,U as A}from"../chunks/vendor-b7a51d2f.js";import{d as F,c as L,e as q,r as B,a as M,b as Z}from"../chunks/store-b1b2bb32.js";import{g as D}from"../chunks/navigation-51f4a605.js";import"../chunks/singletons-12a22614.js";function R(s){let n,t;return{c(){n=b("p"),t=T(s[1])},l(e){n=k(e,"P",{});var i=w(n);t=I(i,s[1]),i.forEach(m)},m(e,i){y(e,n,i),c(n,t)},p(e,i){i&2&&C(t,e[1])},d(e){e&&m(n)}}}function G(s){let n,t,e,i,l,h,f,_,p,u,a=s[1]&&R(s);return{c(){a&&a.c(),n=v(),t=b("form"),e=b("input"),i=v(),l=b("input"),h=v(),f=b("button"),_=T("Submit"),this.h()},l(o){a&&a.l(o),n=S(o),t=k(o,"FORM",{});var r=w(t);e=k(r,"INPUT",{type:!0,name:!0,placeholder:!0}),i=S(r),l=k(r,"INPUT",{type:!0,name:!0,placeholder:!0}),h=S(r),f=k(r,"BUTTON",{});var O=w(f);_=I(O,"Submit"),O.forEach(m),r.forEach(m),this.h()},h(){d(e,"type","email"),d(e,"name","email"),d(e,"placeholder","email"),d(l,"type","password"),d(l,"name","password"),d(l,"placeholder","password")},m(o,r){a&&a.m(o,r),y(o,n,r),y(o,t,r),c(t,e),g(e,s[0].email),c(t,i),c(t,l),g(l,s[0].password),c(t,h),c(t,f),c(f,_),p||(u=[j(e,"input",s[3]),j(l,"input",s[4]),j(t,"submit",J(function(){z(s[2](s[0]))&&s[2](s[0]).apply(this,arguments)}))],p=!0)},p(o,[r]){s=o,s[1]?a?a.p(s,r):(a=R(s),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null),r&1&&e.value!==s[0].email&&g(e,s[0].email),r&1&&l.value!==s[0].password&&g(l,s[0].password)},i:N,o:N,d(o){a&&a.d(o),o&&m(n),o&&m(t),p=!1,A(u)}}}function H(s,n,t){let e={password:"",email:""},i=null;const l=async _=>{console.log(API_URL);try{const p=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(p.status>=300)throw await p.json();const u=await p.json();console.log({parseRes:u}),localStorage.setItem("access_token",u.access_token),localStorage.setItem("refresh_token",u.refresh_token);const a=JSON.stringify(u.user);localStorage.setItem("user",a),F.set(u.user),L.set(u.access_token),q.set(u.refresh_token);const o=u.user.roles;for(const r of o)switch(r.name){case"user":Z.set(!0);break;case"eventOrganizer":M.set(!0);break;case"admin":B.set(!0);break}D("/profile")}catch(p){t(1,i=p)}};function h(){e.email=this.value,t(0,e)}function f(){e.password=this.value,t(0,e)}return[e,i,l,h,f]}class X extends U{constructor(n){super();E(this,n,H,G,P,{})}}export{X as default};
