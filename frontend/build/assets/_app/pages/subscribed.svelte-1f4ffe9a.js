import{S as A,i as K,s as X,e as T,c as R,a as C,d as S,f as I,X as Y,l as U,J as D,K as L,A as z,t as v,g as m,b as F,F as f,L as P,h as N,U as B,Y as G}from"../chunks/vendor-b7a51d2f.js";import{d as O,e as H,c as Q,v as V}from"../chunks/store-b1b2bb32.js";import{g as W}from"../chunks/navigation-51f4a605.js";import"../chunks/singletons-12a22614.js";function J(u,t,e){const o=u.slice();return o[11]=t[e],o}function M(u){let t,e=[],o=new Map,c=u[1];const p=s=>s[11]._id;for(let s=0;s<c.length;s+=1){let n=J(u,c,s),_=p(n);o.set(_,e[s]=q(_,n))}return{c(){t=T("ul");for(let s=0;s<e.length;s+=1)e[s].c()},l(s){t=R(s,"UL",{});var n=C(t);for(let _=0;_<e.length;_+=1)e[_].l(n);n.forEach(S)},m(s,n){I(s,t,n);for(let _=0;_<e.length;_+=1)e[_].m(t,null)},p(s,n){n&3&&(c=s[1],e=Y(e,n,p,1,s,c,o,t,G,q,null,J))},d(s){s&&S(t);for(let n=0;n<e.length;n+=1)e[n].d()}}}function q(u,t){let e,o=t[11].title+"",c,p,s=t[11].date+"",n,_,g=t[11].artistName+"",y,j,i,E,r,a,d,w,k,b;return{key:u,first:null,c(){e=T("li"),c=v(o),p=v(" at "),n=v(s),_=v("!The great "),y=v(g),j=v(` gonna be there!!!\u{1F91F} 
                `),i=T("input"),r=v(`
                \u274C Remove from Subscriptions
                `),a=T("input"),w=v(`
                Check more
            `),this.h()},l(h){e=R(h,"LI",{});var l=C(e);c=m(l,o),p=m(l," at "),n=m(l,s),_=m(l,"!The great "),y=m(l,g),j=m(l,` gonna be there!!!\u{1F91F} 
                `),i=R(l,"INPUT",{type:!0}),r=m(l,`
                \u274C Remove from Subscriptions
                `),a=R(l,"INPUT",{type:!0}),w=m(l,`
                Check more
            `),l.forEach(S),this.h()},h(){F(i,"type","radio"),i.__value=E={type:"subscriptions",action:"DELETE",eventId:t[11]._id},i.value=i.__value,t[3][0].push(i),F(a,"type","radio"),a.__value=d=t[11],a.value=a.__value,t[3][0].push(a),this.first=e},m(h,l){I(h,e,l),f(e,c),f(e,p),f(e,n),f(e,_),f(e,y),f(e,j),f(e,i),i.checked=i.__value===t[0],f(e,r),f(e,a),a.checked=a.__value===t[0],f(e,w),k||(b=[P(i,"change",t[2]),P(a,"change",t[4])],k=!0)},p(h,l){t=h,l&2&&o!==(o=t[11].title+"")&&N(c,o),l&2&&s!==(s=t[11].date+"")&&N(n,s),l&2&&g!==(g=t[11].artistName+"")&&N(y,g),l&2&&E!==(E={type:"subscriptions",action:"DELETE",eventId:t[11]._id})&&(i.__value=E,i.value=i.__value),l&1&&(i.checked=i.__value===t[0]),l&2&&d!==(d=t[11])&&(a.__value=d,a.value=a.__value),l&1&&(a.checked=a.__value===t[0])},d(h){h&&S(e),t[3][0].splice(t[3][0].indexOf(i),1),t[3][0].splice(t[3][0].indexOf(a),1),k=!1,B(b)}}}function Z(u){let t,e=u[1]&&u[1].length>0&&M(u);return{c(){e&&e.c(),t=U()},l(o){e&&e.l(o),t=U()},m(o,c){e&&e.m(o,c),I(o,t,c)},p(o,[c]){o[1]&&o[1].length>0?e?e.p(o,c):(e=M(o),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:D,o:D,d(o){e&&e.d(o),o&&S(t)}}}function $(u,t,e){let o,c,p;L(u,O,r=>e(5,o=r)),L(u,H,r=>e(6,c=r)),L(u,Q,r=>e(7,p=r));let s,n;const _=async r=>{console.log(r),V.set(r),W("/event")},g=async r=>{try{const{type:a,action:d,eventId:w}=r;let k;d=="DELETE"?k="from":k="to";const b=await fetch(`http://localhost:5000/api/user/concert-${k}-${a}/${w}`,{method:d,headers:{"Content-Type":"application/json",access_token:p,refresh_token:c}});if(console.log(b),b.status>=300)throw await b.json();const h=await b.json();O.set(h.user),e(1,s=s.filter(l=>l._id!=w)),console.log(h),O.set(h.user)}catch(a){console.error(a)}},y=async()=>{try{const r=await fetch("http://localhost:5000/api/user/concerts-by-ids",{method:"POST",headers:{"Content-Type":"application/json",access_token:p,refresh_token:c},body:JSON.stringify(o.concertSubscriptions)});if(r.status>=300)throw await r.json();const a=await r.json();return console.log({parseRes:a}),a.events}catch(r){console.error(r)}};z(async()=>{e(1,s=await y()),console.log({events:s})});const j=[[]];function i(){n=this.__value,e(0,n)}function E(){n=this.__value,e(0,n)}return u.$$.update=()=>{u.$$.dirty&1&&n&&(n._id?_(n):g(n))},[n,s,i,j,E]}class ne extends A{constructor(t){super();K(this,t,$,Z,X,{})}}export{ne as default};
